# Activity_Recognition

Repo uses pose estimation to create a dataset from videos and then trains a classifier to recognise the activity.

## Observation About Train Data

* The dataset is not clean enough
* There are a lot of poses inside a single video or a lot of noise
* For eg. in a video of jumping jacks:  person1 is standing and person2 is doing a jumping jack
* There are a group of 15-20 people doing a jumping jack in the video
* The form of the jumping jack is not quite correct in many videos
* Many people are doing a variation of jumping jack, for eg, one jump jack then one standing ab crunch, which again adds to the noise of the data
* Few videos have T-shaped jumping jacks, starfish jacks, burpee jacks, and many more other forms of jumping jacks, which adds to the noise and hence can throw off the classifier.
* Most of these issues are there in all types of exercises not just in jumping jack.
* Timestamped data would be required to solve this problem better, where the exercise started and where it ended.
* There are a lot of vids in the training data which are not time-stamped correctly, for eg. the video starts at 0sec but the exercise starts at 7th sec or so.
* Timestamping properly can help a lot in the temporal dependence issues and make the model more robust and better


## Pipeline Created

* Videos are read and converted to frames
* 4 frames are picked up every second [we can pick up even more frames, though due to resource restriction, I used 4FPS]
* Mediapipe pose estimation model is run on top of the frames, to generate poses on top of the frames and also create a CSV file per class, for all the poses.

### Input Image:: 

![alt text]([(https://github.com/pratyushlohumi26/Activity_Recognition/blob/main/input-frame.png])?raw=true)

### Output Generated by Mediapipe:




#### Similarly, CSV files are also created.

* A classifier is built on top of it using the CSV data of poses.
* KNN classifier is used on top of the csv created
* As Knn works on distances, thresholding the classifier for different poses 
* Understanding the different clusters by KNN can help us come up with good classification boundaries and classify train/val data from random and idle exercises.
* The Knn algorithm is robust to outliers, and as our training data contains a good amount of outliers, that is why the motivation to use KNN has come into the picture.
* As KNN is a simple and easy-to-understand classifier that works on distances, in our case, After removing outliers we can find the nearest pose by mean distances.

* Classifier is then tested on videos directly.

#### The output of the classifier::





* This is a screenshot of the video, I couldnâ€™t attach the video here.

